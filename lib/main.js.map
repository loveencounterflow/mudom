{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/main.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\nloupe                     = require '../loupe.js'\nmisfit                    = Symbol 'misfit'\ndebug                     = console.debug\n{ isa\n  validate }              = require './types'\nµ                         = @\n\n#-----------------------------------------------------------------------------------------------------------\nINTERTEXT =\n  camelize: ( text ) ->\n    ### thx to https://github.com/lodash/lodash/blob/master/camelCase.js ###\n    words = text.split '-'\n    for idx in [ 1 ... words.length ] by +1\n      word = words[ idx ]\n      continue if word is ''\n      words[ idx ] = word[ 0 ].toUpperCase() + word[ 1 .. ]\n    return words.join ''\n\n\n#===========================================================================================================\n#\n#-----------------------------------------------------------------------------------------------------------\nclass Text\n  #---------------------------------------------------------------------------------------------------------\n  rpr:          ( x     ) -> loupe.inspect x\n  _pen1:        ( x     ) -> if isa.text x then x else @rpr x\n  pen:          ( P...  ) -> ( P.map ( x ) => @_pen1        x ).join ' '\n  pen_escape:   ( P...  ) -> ( P.map ( x ) => @_pen_escape1 x ).join ' '\n  log:          ( P...  ) -> console.log @pen P...\n\n  #---------------------------------------------------------------------------------------------------------\n  _pen_escape1: ( x ) ->\n    return @_escape x           if isa.text     x\n    return @_escape x.outerHTML if isa.element  x\n    return @rpr x\n\n  #---------------------------------------------------------------------------------------------------------\n  _escape: ( x ) -> x.replace( /&/g, '&amp;' ).replace( /</g, '&lt;' ).replace( />/g, '&gt;' )\n\n#===========================================================================================================\n#\n#-----------------------------------------------------------------------------------------------------------\nclass Dom # extends Multimix\n  ### inspired by http://youmightnotneedjquery.com\n  and https://blog.garstasio.com/you-dont-need-jquery ###\n\n  #=========================================================================================================\n  #\n  #---------------------------------------------------------------------------------------------------------\n  ready: ( f ) ->\n    # thx to https://stackoverflow.com/a/7053197/7568091\n    # function r(f){/in/.test(document.readyState)?setTimeout(r,9,f):f()}\n    validate.ready_callable f\n    return ( setTimeout ( => @ready f ), 9 ) if /in/.test document.readyState\n    return f()\n\n\n  #=========================================================================================================\n  # WARNINGS, NOTIFICATIONS\n  #---------------------------------------------------------------------------------------------------------\n  _notify: ( message ) ->\n    id          = 'msgbx49573'\n    message_box = @select \"#{id}\", null\n    if message_box is null\n      body            = @select 'body', null\n      ### TAINT body element cannot be found when method is called before document ready, but we could still\n      construct element immediately, append it on document ready ###\n      return unless body?\n      style           = \"background:#18171d;\"\n      style          += \"position:fixed;\"\n      style          += \"bottom:0mm;\"\n      style          += \"border:1mm dashed #e2ff00;\"\n      style          += \"padding-left:3mm;\"\n      style          += \"padding-right:3mm;\"\n      style          += \"padding-bottom:3mm;\"\n      style          += \"font-family:sans-serif;\"\n      style          += \"font-weight:bold !important;\"\n      style          += \"font-size:3mm;\"\n      style          += \"color:#e2ff00;\"\n      style          += \"width:100%;\"\n      style          += \"max-height:30mm;\"\n      style          += \"overflow-y:scroll;\"\n      message_box     = @parse_one \"<div id=#{id} style='#{style}'></div>\"\n      @append body, message_box\n    message_p       = \"<p style='padding-top:3mm;'>\"\n    message_p      += \"⚠️&nbsp;<strong>\"\n    message_p      += µ.TEXT.pen_escape message\n    message_p      += \"</strong></p>\"\n    message_p       = @parse_one message_p\n    @insert_as_last message_box, message_p\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  warn: ( P... ) ->\n    ### Construct a text message for display in console and in notification box, alongside with a stack trace\n    to be shown only in the console, preced by the original arguments as passed into this function,\n    meaning that any DOM elements will be expandable links to their visible representations on the HTML\n    page. ###\n    message = µ.TEXT.pen P...\n    error   = new Error message\n    console.groupCollapsed P[ 0 ]\n    console.warn P...\n    console.groupEnd()\n    @_notify message\n\n  #=========================================================================================================\n  #\n  #---------------------------------------------------------------------------------------------------------\n  ### NOTE `µ.DOM.select()` to be deprecated in favor of `µ.DOM.select_first()` ###\n  select:       ( selector, fallback = misfit ) -> @select_first    document, selector, fallback\n  select_first: ( selector, fallback = misfit ) -> @select_from     document, selector, fallback\n  select_all:   ( selector                    ) -> @select_all_from document, selector\n\n  #---------------------------------------------------------------------------------------------------------\n  ### NOTE `µ.DOM.select_from()` to be deprecated in favor of `µ.DOM.select_first_from()` ###\n  select_from: ( element, selector, fallback = misfit ) -> @select_first_from element, selector, fallback\n  select_first_from: ( element, selector, fallback = misfit ) ->\n    validate.delement element\n    validate.nonempty_text selector\n    unless ( R = element.querySelector selector )?\n      throw new Error \"^µDOM/select_from@7758^ no such element: #{µ.TEXT.rpr selector}\" if fallback is misfit\n      return fallback\n    return R\n\n  #---------------------------------------------------------------------------------------------------------\n  select_all_from: ( element, selector ) ->\n    validate.delement element\n    validate.nonempty_text selector\n    return element.querySelectorAll selector\n    # Array.from element.querySelectorAll selector\n\n  #---------------------------------------------------------------------------------------------------------\n  select_id:  ( id, fallback = misfit ) ->\n    validate.nonempty_text id\n    unless ( R = document.getElementById id )?\n      throw new Error \"^µDOM/select_id@7758^ no element with ID: #{µ.TEXT.rpr id}\" if fallback is misfit\n      return fallback\n    return R\n\n  #---------------------------------------------------------------------------------------------------------\n  matches_selector: ( element, selector ) ->\n    unless isa.function element?.matches\n      throw new Error \"^µDOM/select_id@77581^ expected element with `match()` method, got #{µ.TEXT.rpr element}\"\n    return element.matches selector\n\n  #---------------------------------------------------------------------------------------------------------\n  get:              ( element, name             ) -> validate.element element; element.getAttribute name\n  get_numeric:      ( element, name             ) -> parseFloat @get element, name\n  # When called with two arguments as in `set div, 'bar'`, will set values-less attribute (`<div bar>`)\n  set:              ( element, name, value = '' ) -> validate.element element; element.setAttribute name, value\n  #---------------------------------------------------------------------------------------------------------\n  get_classes:      ( element                   ) -> validate.element element; element.classList\n  add_class:        ( element, name             ) -> validate.element element; element.classList.add      name\n  has_class:        ( element, name             ) -> validate.element element; element.classList.contains name\n  remove_class:     ( element, name             ) -> validate.element element; element.classList.remove   name\n  toggle_class:     ( element, name             ) -> validate.element element; element.classList.toggle   name\n  #---------------------------------------------------------------------------------------------------------\n  swap_class: ( element, old_name, new_name ) ->\n    element.classList.remove  old_name\n    element.classList.add     new_name\n  #---------------------------------------------------------------------------------------------------------\n  hide:             ( element                   ) -> validate.element element; element.style.display = 'none'\n  show:             ( element                   ) -> validate.element element; element.style.display = ''\n  #---------------------------------------------------------------------------------------------------------\n  get_live_styles:  ( element                   ) -> getComputedStyle element ### validation done by method ###\n  ###\n  globalThis.get_style = ( element, pseudo_selector, attribute_name ) ->\n    unless attribute_name?\n      [ pseudo_selector, attribute_name, ] = [ undefined, pseudo_selector, ]\n    style = window.getComputedStyle element, pseudo_selector\n    return style.getPropertyValue attribute_name\n  ###\n  ### TAINT also use pseudo_selector, see above ###\n  ### validation done by method ###\n  get_style_value:          ( element, name ) ->            ( getComputedStyle element )[ name ]\n  get_numeric_style_value:  ( element, name ) -> parseFloat ( getComputedStyle element )[ name ]\n  ### thx to https://davidwalsh.name/css-variables-javascript ###\n  get_prop_value:           ( element, name ) ->            ( getComputedStyle element ).getPropertyValue name\n  get_numeric_prop_value:   ( element, name ) -> parseFloat ( getComputedStyle element ).getPropertyValue name\n  ### thx to https://davidwalsh.name/css-variables-javascript ###\n  get_global_prop_value:          ( name ) ->             ( getComputedStyle document ).getPropertyValue name\n  get_numeric_global_prop_value:  ( name ) ->  parseFloat ( getComputedStyle document ).getPropertyValue name\n  set_global_prop_value:    ( name, value ) -> document.documentElement.style.setProperty name, value\n# #-----------------------------------------------------------------------------------------------------------\n# set_prop_defaults = ->\n#   ### There shoud be a better way to inject styles ###\n#   return null if _set_prop_defaults\n#   # head_dom = µ.DOM.select_first 'head'\n#   # style_txt = \"\"\"\n#   # <style>\n#   #   * {\n#   #     outline:       2px solid yellow; }\n#   #   </style>\n#   # \"\"\"\n#   # head_dom.innerHTML = style_txt + head_dom.innerHTML\n#   tophat_dom = µ.DOM.select_first '#tophat'\n#   µ.DOM.insert_before tophat_dom, µ.DOM.parse_one \"\"\"\n#   <style>\n#     * {\n#       outline:       2px solid yellow; }\n#     :root {\n#       --hstn-slider-track-bgcolor:    lime; }\n#     </style>\n#   \"\"\"\n#   return null\n\n  #---------------------------------------------------------------------------------------------------------\n  set_style_rule:   ( element, name, value  ) ->\n    ### see https://developer.mozilla.org/en-US/docs/Web/API/ElementCSSInlineStyle/style ###\n    validate.element element\n    validate.nonempty_text name\n    element.style[ INTERTEXT.camelize name ] = value\n\n  #---------------------------------------------------------------------------------------------------------\n  new_stylesheet: ( text = '' ) ->\n    R = document.createElement 'style'\n    R.appendChild document.createTextNode text\n    return R\n\n\n  #=========================================================================================================\n  # ELEMENT CREATION\n  #---------------------------------------------------------------------------------------------------------\n  parse_one: ( element_html ) ->\n    R = @parse_all element_html\n    unless ( length = R.length ) is 1\n      throw new Error \"^µDOM/parse_one@7558^ expected HTML for 1 element but got #{length}\"\n    return R[ 0 ]\n\n  #---------------------------------------------------------------------------------------------------------\n  parse_all: ( html ) ->\n    ### TAINT return Array or HTMLCollection? ###\n    validate.nonempty_text html\n    R = document.implementation.createHTMLDocument()\n    R.body.innerHTML = html\n    return R.body.children\n\n  #---------------------------------------------------------------------------------------------------------\n  new_element: ( xname, P... ) ->\n    ### TAINT analyze xname (a la `div#id42.foo.bar`) as done in Intertext.Cupofhtml ###\n    ### TAINT in some cases using innerHTML, documentFragment may be advantageous ###\n    R           = document.createElement xname\n    attributes  = {}\n    text        = null\n    for p in P\n      if isa.text p\n        text = p\n        continue\n      attributes = Object.assign attributes, p ### TAINT check type? ###\n    R.textContent = text if text?\n    R.setAttribute k, v for k, v of attributes\n    return R\n\n  #---------------------------------------------------------------------------------------------------------\n  deep_copy: ( element ) -> element.cloneNode true\n\n\n  #=========================================================================================================\n  # OUTER, INNER HTML\n  #---------------------------------------------------------------------------------------------------------\n  get_inner_html:   ( element ) -> validate.element element; element.innerHTML\n  get_outer_html:   ( element ) -> validate.element element; element.outerHTML\n\n\n  #=========================================================================================================\n  # INSERTION\n  #---------------------------------------------------------------------------------------------------------\n  insert: ( position, target, x ) ->\n    switch position\n      when 'before',    'beforebegin' then return @insert_before   target, x\n      when 'as_first',  'afterbegin'  then return @insert_as_first target, x\n      when 'as_last',   'beforeend'   then return @insert_as_last  target, x\n      when 'after',     'afterend'    then return @insert_after    target, x\n    throw new Error \"^µDOM/insert@7758^ not a valid position: #{µ.TEXT.rpr position}\"\n\n  #---------------------------------------------------------------------------------------------------------\n  ### NOTE pending practical considerations and benchmarks we will probably remove one of the two sets\n  of insertion methods ###\n  insert_before:   ( target, x ) -> validate.element target; target.insertAdjacentElement 'beforebegin', x\n  insert_as_first: ( target, x ) -> validate.element target; target.insertAdjacentElement 'afterbegin',  x\n  insert_as_last:  ( target, x ) -> validate.element target; target.insertAdjacentElement 'beforeend',   x\n  insert_after:    ( target, x ) -> validate.element target; target.insertAdjacentElement 'afterend',    x\n\n  #---------------------------------------------------------------------------------------------------------\n  before:   ( target, x... ) -> validate.element target; target.before   x...\n  prepend:  ( target, x... ) -> validate.element target; target.prepend  x...\n  append:   ( target, x... ) -> validate.element target; target.append   x...\n  after:    ( target, x... ) -> validate.element target; target.after    x...\n\n\n  #=========================================================================================================\n  # REMOVAL\n  #---------------------------------------------------------------------------------------------------------\n  remove: ( element ) ->\n    ### see http://youmightnotneedjquery.com/#remove ###\n    validate.element element\n    element.parentNode.removeChild element\n\n\n  #=========================================================================================================\n  # GEOMETRY\n  #---------------------------------------------------------------------------------------------------------\n  ### NOTE observe that `DOM.get_offset_top()` and `element.offsetTop` are two different things; terminology\n  is confusing here, so consider renaming to avoid `offset` altogether ###\n  get_offset_top:  ( element ) -> ( @get_offset element ).top\n  get_offset_left: ( element ) -> ( @get_offset element ).left\n\n  #---------------------------------------------------------------------------------------------------------\n  get_offset: ( element ) ->\n    ### see http://youmightnotneedjquery.com/#offset ###\n    validate.element element\n    rectangle = element.getBoundingClientRect()\n    return {\n      top:  rectangle.top   + document.body.scrollTop\n      left: rectangle.left  + document.body.scrollLeft }\n\n  #---------------------------------------------------------------------------------------------------------\n  ### see http://youmightnotneedjquery.com/#get_width ###\n  get_width:  ( element ) -> @get_numeric_style_value element, 'width'\n  get_height: ( element ) -> @get_numeric_style_value element, 'height'\n\n\n  #=========================================================================================================\n  # EVENTS\n  #---------------------------------------------------------------------------------------------------------\n  on: ( element, name, handler ) ->\n    ### TAINT add options ###\n    ### see http://youmightnotneedjquery.com/#on, http://youmightnotneedjquery.com/#delegate ###\n    ### Also note the addition of a `passive: false` parameter (as in `html_dom.addEventListener 'wheel', f,\n    { passive: false, }`); see https://stackoverflow.com/a/55461632/256361; apparently it is a recently\n    introduced feature of browser event processing; see also [JQuery issue #2871 *Add support for passive\n    event listeners*](https://github.com/jquery/jquery/issues/2871), open as of Dec 2020 ###\n    validate.delement element\n    validate.nonempty_text name\n    validate.function handler\n    return element.addEventListener name, handler, false\n\n  #---------------------------------------------------------------------------------------------------------\n  emit_custom_event: ( name, options ) ->\n    # thx to https://www.javascripttutorial.net/javascript-dom/javascript-custom-events/\n    ### Acc. to https://developer.mozilla.org/en-US/docs/Web/API/Event/Event,\n    https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent, allowable fields for `options`\n    include `bubbles`, `cancelable`, `composed`, `detail`; the last one may contain arbitrary data and can\n    be retrieved as `event.detail`. ###\n    validate.nonempty_text name\n    document.dispatchEvent new CustomEvent name, options\n\n\n  #=========================================================================================================\n  # DRAGGABLES\n  #---------------------------------------------------------------------------------------------------------\n  make_draggable: ( element ) ->\n    ### thx to http://jsfiddle.net/robertc/kKuqH/\n    https://stackoverflow.com/a/6239882/7568091 ###\n    @_attach_dragover()\n    @_prv_draggable_id++\n    id = @_prv_draggable_id\n    @set element, 'draggable', true\n    #.......................................................................................................\n    @on element, 'dragstart', on_drag_start = ( event ) ->\n      style = µ.DOM.get_live_styles event.target\n      x     = ( parseInt style.left, 10 ) - event.clientX\n      y     = ( parseInt style.top,  10 ) - event.clientY\n      event.dataTransfer.setData 'application/json', JSON.stringify { x, y, id, }\n    #.......................................................................................................\n    @on document.body, 'drop', on_drop = ( event ) ->\n      transfer  = JSON.parse event.dataTransfer.getData 'application/json'\n      return unless id is transfer.id\n      left      = event.clientX + transfer.x + 'px'\n      top       = event.clientY + transfer.y + 'px'\n      µ.DOM.set_style_rule element, 'left', left\n      µ.DOM.set_style_rule element, 'top',  top\n      event.preventDefault()\n      return false\n    #.......................................................................................................\n    return null\n  #.........................................................................................................\n  _prv_draggable_id: 0\n\n  #---------------------------------------------------------------------------------------------------------\n  _attach_dragover: ->\n    ### TAINT Apparently need for correct dragging behavior, but what if we wanted to handle this event? ###\n    @on document.body, 'dragover', on_dragover = ( event ) -> event.preventDefault(); return false\n    @_attach_dragover = ->\n    return null\n\n\n  #=========================================================================================================\n  #\n  #---------------------------------------------------------------------------------------------------------\n  _walk_xpath: ( root, path ) ->\n    # thx to https://denizaksimsek.com/2023/xpath/\n    [ root, path ] = [ document, root, ] unless path?\n    iterator = document.evaluate path, root, null, XPathResult.UNORDERED_NODE_ITERATOR_TYPE, null\n    loop\n      break unless ( node = iterator.iterateNext() )?\n      yield node\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  get_document_scroll_top:  -> document.documentElement.scrollTop\n  get_document_scroll_left: -> document.documentElement.scrollLeft\n\n  #---------------------------------------------------------------------------------------------------------\n  wrap_inner: ( element, wrapper ) ->\n    element.appendChild(wrapper);\n    while element.firstChild isnt wrapper\n       wrapper.appendChild element.firstChild\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _XXX_set_iframe_scroll_top: ( iframe, y ) ->\n    ### thx to https://stackoverflow.com/a/1229832/7568091 ###\n    ### Set vertical scroll amount of content shown in an `<iframe>`. ###\n    # ### TAINT API TBD\n    iframe.contentWindow.document.documentElement.scrollTop = y\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  select_first_xpath: ( P... ) -> return R for R from @_walk_xpath P...\n  select_all_xpath:   ( P... ) -> ( R for R from @_walk_xpath P... )\n\n  #---------------------------------------------------------------------------------------------------------\n  page_is_inside_iframe: -> window.location isnt window.parent.location\n\n\n#===========================================================================================================\n# MAGIC\n#-----------------------------------------------------------------------------------------------------------\nµ._magic    = Symbol.for 'µDOM'\nµ.TEXT      = new Text()\nµ.DOM       = new Dom()\nµ.KB        = new ( require './kb' ).Kb()\n\n\n# module.exports.rpr     ?= module.exports.µ.TEXT.rpr.bind( µ.TEXT )\n# module.exports.log     ?= module.exports.µ.TEXT.log.bind( µ.TEXT )\n\n###\n\nhttps://stackoverflow.com/a/117988/7568091\n\ninnerHTML is remarkably fast, and in many cases you will get the best results just setting that (I would\njust use append).\n\nHowever, if there is much already in \"mydiv\" then you are forcing the browser to parse and render all of\nthat content again (everything that was there before, plus all of your new content). You can avoid this by\nappending a document fragment onto \"mydiv\" instead:\n\nvar frag = document.createDocumentFragment();\nfrag.innerHTML = html;\n$(\"#mydiv\").append(frag);\nIn this way, only your new content gets parsed (unavoidable) and the existing content does not.\n\nEDIT: My bad... I've discovered that innerHTML isn't well supported on document fragments. You can use the\nsame technique with any node type. For your example, you could create the root table node and insert the\ninnerHTML into that:\n\nvar frag = document.createElement('table');\nfrag.innerHTML = tableInnerHtml;\n$(\"#mydiv\").append(frag);\n\n\n###\n"
  ]
}